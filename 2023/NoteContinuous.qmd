---
title: "MisLearning BLP"
format: html
---

# SetUp

```{r}
pacman::p_load(
  tidyverse,
  estimatr
)

SimData <- function(i,n){
  set.seed(i)
  TempData <- tibble(
    X = sample(0:3,n,replace = TRUE),
    D = -X^2 + rnorm(n,0,2),
    Y = D + X^4 + rnorm(n,0,10)
  )
  return(TempData)
}

lm_robust(
  Y ~ D + X,
  SimData(1,10000)
)

SimData(1,100) |> 
  ggplot(
    aes(
      x = D,
      y = Y,
      color = X
    )
  ) +
  geom_point()

SimData(1,1000) |> 
  ggplot(
    aes(
      x = D,
      y = Y,
      group = X,
      color = X
    )
  ) +
  theme_bw() +
  geom_point() +
  geom_smooth(
    method = "lm",
    se = FALSE
  )
```

